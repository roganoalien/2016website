var PORTA=function(){var _$window,_$body,_$logo,_$menu,_$scroller,_$scrollObjs,_$project,_$lightbox,_$sendForm,_$rMenu,_alreadyBottom,_bottom,_positions,_posY,_notMobile,_validator,_passEvent,_$header,_alreadySent=!1,_initVars=function(){_$body=$(".content-container"),_$header=$("#header"),_$lightbox=$(".rogano-project"),_$logo=$(".logo"),_$menu=$(".menu a"),_$project=$(".port-container"),_$rMenu=$(".header-container svg"),_$sendForm=$(".send-form"),_$scroller=$("#scroller"),_$scrollObjs=$(".getPos"),_$window=$(window),_alreadyBottom=!1,_bottom=0,_notMobile=!0,_passEvent=!1,_positions=[],_validator=!1},_isMobile=function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){_notMobile=!1;var el=document.getElementById("scroller");_swipeEvent(el,function(swipedir){"up"==swipedir&&(_passEvent||(_landingEffect(),_addMenu(1)))})}},_initEvents=function(){_$rMenu.click(function(){_$header.addClass("open")}),_$logo.click(function(){_$header.hasClass("open")&&_$header.removeClass("open")}),_$sendForm.click(function(e){e.preventDefault(),_alreadySent||(_alreadySent=!0,PORTA.contacto.init())}),_$window.scroll(function(){_passEvent&&_scrollingstuff()}),_$window.bind("mousewheel",function(){_passEvent||(_landingEffect(),_addMenu(1))}),_$menu.on("click",function(event){if(_$this=$(this),_$header.hasClass("open")){if(_$this.hasClass("in-site")){event.preventDefault();var _goTo,_toGo,_scrollTo=_$this.attr("href"),_posY=$(_scrollTo).position();_$header.removeClass("open"),setTimeout(function(){_animateMenu(_scrollTo,_posY,_goTo,_toGo)},500)}}else if(_$this.hasClass("in-site")){event.preventDefault();var _goTo,_toGo,_scrollTo=_$this.attr("href"),_posY=$(_scrollTo).position();_animateMenu(_scrollTo,_posY,_goTo,_toGo)}}),_$project.on("click",function(){var _search=$(this).data("project"),_searchText=_search+".html";_$lightbox.addClass("showing"),$.get(_searchText,function(data){$(".project-content").html(data)}).done(function(){setTimeout(function(){$(".project-content").removeClass("faded")},700),_notMobile&&Ps.initialize(document.getElementById("p-scroll"),{wheelSpeed:1,wheelPropagation:!1,swipePropagation:!1,suppressScrollX:!0})}),$(".close-icon").click(function(){$(".ajax-get").length?($(".project-content").addClass("faded"),setTimeout(function(){_notMobile&&Ps.destroy(document.getElementById("p-scroll")),$(".ajax-get").remove(),_$lightbox.removeClass("showing")},550)):_$lightbox.removeClass("showing")})})},_animateMenu=function(_scrollTo,_posY,_goTo,_toGo){"#top"!=_scrollTo?(_goTo=_posY.top-$("#header").height(),_toGo=_posY.top):_toGo=0,_passEvent?(_getPos(0),_scrollAnimate(_toGo,0,0)):(_landingEffect(),_scrollAnimate(_goTo,700,60))},_getPos=function(resize){(resize=1)&&(_alreadyBottom=!1),_bottom=_$scroller.prop("scrollHeight")-_$scroller.height();var _tempLocate;for(i=0;i<_$scrollObjs.length;i++)_tempLocate=_$scrollObjs.eq(i).position(),_positions[i]=_tempLocate.top},_spyEvent=function(){$(window).scroll(function(){_alreadyBottom||(_alreadyBottom=!0),_posY=$(window).scrollTop(),0==_posY&&_addMenu(0),_posY<_positions[1]&&_posY>0&&_addMenu(1),_posY>=_positions[1]&&_addMenu(2),_posY>=_positions[2]&&_addMenu(3),_posY==_bottom&&_addMenu(3)})},_addMenu=function(number){_$menu.removeClass("selected"),_$menu.eq(number).addClass("selected")},_scrollAnimate=function(posY,theTime,extra){setTimeout(function(){_$scroller.animate({scrollTop:posY+extra},250)},theTime)},_landingEffect=function(){_passEvent=!0,_notMobile&&Ps.destroy(document.getElementById("scroller")),_$header.removeClass("open"),_toggleSmall(),setTimeout(function(){_getPos(0),$("body").removeClass("no-scroll"),_addMenu(1),_notMobile&&Ps.initialize(document.getElementById("scroller"),{wheelSpeed:1,wheelPropagation:!0,swipePropagation:!0,suppressScrollX:!0})},600)},_scrollingstuff=function(){var posY=_$window.scrollTop();0==posY&&($("body").addClass("no-scroll"),_notMobile&&Ps.destroy(document.getElementById("scroller")),_validator=!1,_toggleSmall(),setTimeout(function(){_passEvent=!1},600))},_toggleSmall=function(){_$body.toggleClass("small"),_$header.toggleClass("small")},_swipeEvent=function(el,callback){var swipedir,startX,startY,distX,distY,elapsedTime,startTime,touchsurface=el,threshold=100,restraint=100,allowedTime=300,handleswipe=callback||function(swipedir){};touchsurface.addEventListener("touchstart",function(e){var touchobj=e.changedTouches[0];swipedir="none",dist=0,startX=touchobj.pageX,startY=touchobj.pageY,startTime=(new Date).getTime()},!1),touchsurface.addEventListener("touchmove",function(e){},!1),touchsurface.addEventListener("touchend",function(e){var touchobj=e.changedTouches[0];distX=touchobj.pageX-startX,distY=touchobj.pageY-startY,elapsedTime=(new Date).getTime()-startTime,allowedTime>=elapsedTime&&(Math.abs(distX)>=threshold&&Math.abs(distY)<=restraint?swipedir=0>distX?"left":"right":Math.abs(distY)>=threshold&&Math.abs(distX)<=restraint&&(swipedir=0>distY?"up":"down")),handleswipe(swipedir)},!1)};return{init:function(){_initVars(),_isMobile(),$(window).resize(function(){_getPos(1)}),_initEvents(),_spyEvent()}}}();PORTA.contacto=function(){var _processForm=function(){$("input").removeClass("animated shake error"),$("textarea").removeClass("animated shake error");var name=$("input#name").val();if(""==name)return $("input#name").addClass("animated shake error"),!1;var email=$("input#email").val();if(""==email)return $("input#email").addClass("animated shake error"),!1;isEmail(email);var tel=$("input#tel").val();if(tel.length<10)return $("input#tel").addClass("animated shake error"),!1;var asunto=$("input#asunto").val(),contenido=$("textarea#contenido").val();if(contenido.length<10)return $("textarea#contenido").addClass("animated shake error"),!1;var mensaje="Nombre: "+name+"\n Email: "+email+"\n Tel: "+tel+"\n Asunto: "+asunto+"\n Mensaje: "+contenido;return $.ajax({type:"POST",url:"man/process.php",data:{mensaje:mensaje},success:function(){PORTA.alert.success()},error:function(){PORTA.alert.error()}}),!1},isEmail=function(email){var pattern=/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;return pattern.test(email)?void 0:($("input#email").addClass("animated shake error"),!1)};return{init:function(){_processForm()}}}(),PORTA.alert=function(){var alert=function(validate){var titulo,clase,mensaje;1==validate&&(titulo="¡Gracias!",clase="success",mensaje="En breve me pondré en contacto contigo."),0==validate&&(titulo="¡Error!",clase="error",mensaje="Parece que hubo un error :(, intenta de nuevo."),$("body").append("<div class='rogano-alert faded'><div class='alert-bg close-it'></div><div class='alert-content "+clase+"'><p class='content-title "+clase+"'>"+titulo+"</p><p class='content-msg'>"+mensaje+"</p><div class='close-btn close-it "+clase+"'>Cerrar</div></div></div>"),setTimeout(function(){$(".rogano-alert").removeClass("faded")},250),$(".close-it").click(function(){$(".rogano-alert").addClass("faded"),setTimeout(function(){$(".rogano-alert").remove()},1e3)})};return{success:function(){alert(1)},error:function(){alert(0)}}}();
